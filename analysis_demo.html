<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Example usage and output &#8212; qMET: Quality Assurance in Metabolomics 0.1.2 documentation</title>
    
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="The qMET Project class" href="Project.html" /> 
  </head>
  <body role="document">
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="index.html">qMET: Quality Assurance in Metabolomics 0.1.2 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="Project.html" title="The qMET Project class"
             accesskey="P">previous</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput > div,
div.nbinput div[class^=highlight],
div.nbinput div[class^=highlight] pre,
div.nboutput,
div.nboutput > div,
div.nboutput div[class^=highlight],
div.nboutput div[class^=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class^=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput > :first-child pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput > :first-child pre {
    color: #D84315;
}

/* all prompts */
div.nbinput > :first-child[class^=highlight],
div.nboutput > :first-child[class^=highlight],
div.nboutput > :first-child {
    min-width: 7ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}

/* input/output area */
div.nbinput > :nth-child(2)[class^=highlight],
div.nboutput > :nth-child(2),
div.nboutput > :nth-child(2)[class^=highlight] {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}

/* input area */
div.nbinput > :nth-child(2)[class^=highlight] {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput  > :nth-child(2).stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="section" id="Example-usage-and-output">
<h1>Example usage and output<a class="headerlink" href="#Example-usage-and-output" title="Permalink to this headline">¶</a></h1>
<p>This document shows example usage and output from the qMET interlaboratory study analysis code. It shows how to generate the project metadata,</p>
<div class="section" id="Imports">
<h2>Imports<a class="headerlink" href="#Imports" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">qmet</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Prepare-project--data-and-metadata">
<h2>Prepare project  data and metadata<a class="headerlink" href="#Prepare-project--data-and-metadata" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Sample-labels">
<h3>Sample labels<a class="headerlink" href="#Sample-labels" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">Spectrum_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;S1a&#39;</span><span class="p">,</span> <span class="s1">&#39;S1b&#39;</span><span class="p">,</span> <span class="s1">&#39;S1c&#39;</span><span class="p">,</span> <span class="s1">&#39;S1d&#39;</span><span class="p">,</span> <span class="s1">&#39;S1e&#39;</span><span class="p">,</span> <span class="s1">&#39;S1f&#39;</span><span class="p">,</span> <span class="s1">&#39;S2&#39;</span><span class="p">,</span> <span class="s1">&#39;S3&#39;</span><span class="p">,</span> <span class="s1">&#39;S4&#39;</span><span class="p">,</span> <span class="s1">&#39;S5&#39;</span><span class="p">,</span> <span class="s1">&#39;S6&#39;</span> <span class="p">]</span>
<span class="n">Labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;0115&#39;</span><span class="p">,</span>
          <span class="s1">&#39;0122&#39;</span><span class="p">,</span>
          <span class="s1">&#39;0258&#39;</span><span class="p">,</span>
          <span class="s1">&#39;0333&#39;</span><span class="p">,</span>
          <span class="s1">&#39;0711&#39;</span><span class="p">,</span>
          <span class="s1">&#39;0714&#39;</span><span class="p">,</span>
          <span class="s1">&#39;2861&#39;</span><span class="p">,</span>
          <span class="s1">&#39;7042&#39;</span><span class="p">,</span>
          <span class="s1">&#39;8865&#39;</span><span class="p">,</span>
          <span class="s1">&#39;9541&#39;</span><span class="p">]</span>

</pre></div>
</div>
</div>
</div>
<div class="section" id="Spectral-data">
<h3>Spectral data<a class="headerlink" href="#Spectral-data" title="Permalink to this headline">¶</a></h3>
<p>This section defines the file containing the project data, the number of bins that will be used in the histograms, and the range of the project data that will actually be used (in this case, some data is removed due to inconsistencies in suppressing the water signal).</p>
<div class="nbinput nblast docutils container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1">#File containing the raw NMR data</span>
<span class="n">data_file_name</span> <span class="o">=</span> <span class="s2">&quot;mann.test&quot;</span>

<span class="c1">#The range of the data that will actually be used</span>
<span class="n">range_to_use</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">959</span><span class="p">))</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1058</span><span class="p">,</span><span class="mi">1860</span><span class="p">))</span> <span class="c1"># This removes an extra region around the water signal region</span>
<span class="c1">#range_to_use = None</span>

<span class="c1">#Number of bins for the histogram</span>
<span class="n">num_bins</span> <span class="o">=</span> <span class="mi">20</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="X-data">
<h3>X-data<a class="headerlink" href="#X-data" title="Permalink to this headline">¶</a></h3>
<p>Bin centers for binned NMR spectra</p>
<div class="nbinput nblast docutils container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">peakPPM_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">&#39;bins.txt&#39;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Distance-metrics">
<h3>Distance metrics<a class="headerlink" href="#Distance-metrics" title="Permalink to this headline">¶</a></h3>
<p>The interspectral distance metrics used to calculate</p>
<div class="nbinput nblast docutils container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">jeffries</span> <span class="o">=</span> <span class="s1">r&#39;Symmetric Kullback-Liebler&#39;</span>
<span class="n">jensen</span> <span class="o">=</span> <span class="s1">r&#39;Jensen-Shannon&#39;</span>
<span class="n">hellinger</span> <span class="o">=</span> <span class="s1">r&#39;Hellinger&#39;</span>
<span class="n">mahalanobis</span> <span class="o">=</span> <span class="s1">r&#39;Mahalanobis&#39;</span>
<span class="n">nmr_distance_metrics</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="n">mahalanobis</span><span class="p">,</span><span class="n">function</span><span class="o">=</span><span class="s1">&#39;mahalanobis&#39;</span><span class="p">),</span>
                        <span class="nb">dict</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="n">hellinger</span><span class="p">,</span><span class="n">function</span><span class="o">=</span><span class="n">qmet</span><span class="o">.</span><span class="n">hellinger_hyp</span><span class="p">),</span>
                        <span class="nb">dict</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="n">jeffries</span><span class="p">,</span><span class="n">function</span><span class="o">=</span><span class="n">qmet</span><span class="o">.</span><span class="n">jeffries</span><span class="p">),</span>
                        <span class="nb">dict</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="n">jensen</span><span class="p">,</span><span class="n">function</span><span class="o">=</span><span class="n">qmet</span><span class="o">.</span><span class="n">jensen_hyp</span><span class="p">)</span>
                       <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Creating-the-Project-and-loading-the-data">
<h2>Creating the Project and loading the data<a class="headerlink" href="#Creating-the-Project-and-loading-the-data" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Creating-the-Project">
<h3>Creating the Project<a class="headerlink" href="#Creating-the-Project" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">synthetic_samples_project</span> <span class="o">=</span> <span class="n">qmet</span><span class="o">.</span><span class="n">Project</span><span class="p">(</span><span class="n">x_data_list</span><span class="o">=</span><span class="n">peakPPM_full</span><span class="p">,</span>
                                    <span class="n">Sample_names</span><span class="o">=</span><span class="n">Spectrum_names</span><span class="p">,</span>
                                    <span class="n">Data_set_names</span><span class="o">=</span><span class="n">Labels</span><span class="p">,</span>
                                    <span class="n">distance_metric_dict</span><span class="o">=</span><span class="n">nmr_distance_metrics</span><span class="p">,</span>
                                    <span class="n">range_to_use</span><span class="o">=</span><span class="n">range_to_use</span>
                                   <span class="p">)</span>

</pre></div>
</div>
</div>
</div>
<div class="section" id="Loading-the-Project-data">
<h3>Loading the Project data<a class="headerlink" href="#Loading-the-Project-data" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data_file_name</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="docutils container">
</div>
<div class="docutils container">
<div class="highlight"><pre>
mann.test
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="The-data-process-workflow">
<h2>The data process workflow<a class="headerlink" href="#The-data-process-workflow" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">process_mahalanobis</span><span class="p">()</span>
<span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">set_distances</span><span class="p">()</span>
<span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">set_zscores</span><span class="p">()</span>
<span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">set_zscore_principal_components</span><span class="p">()</span>
<span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">find_all_outliers</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Data-Visualization">
<h2>Data Visualization<a class="headerlink" href="#Data-Visualization" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Distance-measure-figures">
<h3>Distance measure figures<a class="headerlink" href="#Distance-measure-figures" title="Permalink to this headline">¶</a></h3>
<p>This example shows the default distance measure figure with no arguments.</p>
<div class="nbinput docutils container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">out_fig</span> <span class="o">=</span> <span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">plot_distance_fig</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="docutils container">
</div>
<div class="docutils container">
<img alt="_images/analysis_demo_17_0.png" src="_images/analysis_demo_17_0.png" />
</div>
</div>
<p>Here is an example plotting only three samples and two distance metrics.</p>
<div class="nbinput docutils container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">out_fig</span> <span class="o">=</span> <span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">plot_distance_fig</span><span class="p">(</span><span class="n">plot_range</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;BuPu&#39;</span><span class="p">,</span><span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">distance_metrics</span><span class="o">=</span><span class="p">[</span><span class="n">mahalanobis</span><span class="p">,</span><span class="n">jeffries</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="docutils container">
</div>
<div class="docutils container">
<img alt="_images/analysis_demo_19_0.png" src="_images/analysis_demo_19_0.png" />
</div>
</div>
</div>
<div class="section" id="Average-distance-histograms">
<h3>Average distance histograms<a class="headerlink" href="#Average-distance-histograms" title="Permalink to this headline">¶</a></h3>
<p>This is the default output of the</p>
<div class="nbinput docutils container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">out_fig</span> <span class="o">=</span> <span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">plot_distance_histograms</span><span class="p">(</span><span class="n">jeffries</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="docutils container">
</div>
<div class="docutils container">
<img alt="_images/analysis_demo_21_0.png" src="_images/analysis_demo_21_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="docutils container">
</div>
<div class="docutils container">
<img alt="_images/analysis_demo_21_1.png" src="_images/analysis_demo_21_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">out_fig</span> <span class="o">=</span> <span class="n">synthetic_samples_project</span><span class="o">.</span><span class="n">plot_distance_histograms</span><span class="p">(</span><span class="n">jeffries</span><span class="p">,</span><span class="n">numcols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">plot_range</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Project.html">The qMET Project class</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Example usage and output</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Imports">Imports</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Prepare-project--data-and-metadata">Prepare project  data and metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Creating-the-Project-and-loading-the-data">Creating the Project and loading the data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#The-data-process-workflow">The data process workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Data-Visualization">Data Visualization</a></li>
</ul>
</li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="Project.html" title="The qMET Project class"
              >previous</a> |
            <a href="genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="_sources/analysis_demo.ipynb.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright .
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>